# การคอมไพล์คืออะไร

ด้านล่างนี้คือโปรแกรมง่าย ๆ ที่แสดงข้อความทั่วไป

```c++
#include <iostream>

using std::cout;
using std::endl;

int main(int argc, char *argv[])
{
    cout << "I am Harry, Harry Potter." << endl;

    return 0;
}
```

ในการสร้างโปรแกรม (ไฟล์ executable) จากไฟล์ source code ของ C++ นั้นจะผ่าน 2 ขั้นตอนดังนี้

  - การคอมไพล์ "compilation" ไฟล์ object files (\*.o) ขึ้นมาก่อนจากไฟล์ source code (\*.cc) ซึ่งทำได้โดยใช้คำสั่ง: `c++ -c welcome.cc`
  - การเชื่อมโยง "linking" เป็นการที่เรานำ object codes ทั้งหมดเข้ามาต่อเข้าด้วยกันเพื่อให้รวมให้เป็นไฟล์ executable จริง ๆ อันเดียว ซึ่งทำได้โดย `c++ welcome.o -o welcome`

ไฟล์ object นั้นเป็นการเก็บข้อมูลการแปล source code ที่เราเขียนให้เป็น machine code อย่างไรก็ตามไฟล์ object นั้นไม่ไฟล์ executable ที่เราจะสามารถนำไปรันได้เพราะว่ามันไม่ได้ผ่านขั้นตอนที่จะทำให้ได้ไฟล์ที่สมบูรณ์ออกมาเพื่อให้นำไปรันได้ ดังนั้นวัตถุประสงค์ของการทำ linking ก็คือการเติมส่วนที่ขาดหายไปให้กับไฟล์ object เพื่อสร้างไฟล์โปรแกรมจริง ๆ ของเราขึ้นมา

โค้ดข้างบนที่ผมเอามาโชว์นั้นจริง ๆ แล้วถูกเขียนขึ้นมาเพื่อให้แสดงข้อความที่มีคำไม่กี่คำผ่านทางหน้าจอซึ่งจะถูกกำหนดโดยสิ่งที่เรียกว่า file stream ที่มีชื่อว่า cout แต่ว่าจริง ๆ แล้ว source code ของเรานั้นไม่ได้มีการกำหนดนิยามหรือ define ว่า `cout` นั้นคืออะไร ดังนั้นไฟล์ object `welcome.o` ที่ถูกสร้างขึ้นมานั้นจะทำการรวม undefined reference ของ cout (หรือที่เราเรียกว่า symbol) เข้าไปด้วยแล้วทำการลิงก์ไปที่ definition จริง ๆ ซึ่งถูกเขียนไว้ในไฟล์ไลบรารี่ที่ชื่อว่า `libstdc++` ซึ่งก็จะถูกเก็บไว้ใน folder ที่ตัว compiler นั้นเก็บไลบรารี่ไฟล์ไว้นั่นเอง

สรุปอีกครั้งก็คือโปรแกรมด้านบนนั้นประกอบไปด้วย 2 ส่วน

1. ในส่วนแรกสุดที่เราเรียกว่า preamble นั้นเป็นการ refer ถึงไฟล์ header `iostream.h` (ตอนแรกใช้งานจะไม่มี .h นะ) ซึ่งไฟล์ header อันนี้จะเป็นการเรียกใช้ declaration ของ object เข้ามาซึ่งในกรณีนี้คือ cout ซึ่งจะเป็นการบอกคอทไพล์เลอร์ว่า cout นั้นทำหน้าที่อะไร 
2. ฟังก์ชัน main นั้นเป็นจุดเริ่มต้นของโปรแกรมทั้งหมดซึ่งใน C++ นั้นมีฟังก์ชัน main ได้ 1 อันเท่านั้นและต้องมีด้วย (ถ้าไม่มีไม่ได้นะ)
